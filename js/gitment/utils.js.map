{"version":3,"sources":["../src/utils.js"],"names":["getTargetContainer","isString","toString","call","s","container","targetContainer","Element","document","getElementById","createElement","Query","parse","search","window","location","queryString","substring","query","split","forEach","queryStr","key","value","stringify","prefix","Object","keys","map","encodeURIComponent","join","ajaxFactory","method","apiPath","data","base","req","XMLHttpRequest","token","localStorage","getItem","LS_ACCESS_TOKEN_KEY","url","body","p","Promise","resolve","reject","addEventListener","contentType","getResponseHeader","res","responseText","test","JSON","message","Error","error","open","setRequestHeader","send","http","get","post","delete","put"],"mappings":"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","file":"utils.js","sourcesContent":["import { LS_ACCESS_TOKEN_KEY } from './constants'\n\nexport const isString = s => toString.call(s) === '[object String]'\n\nexport function getTargetContainer(container) {\n  let targetContainer\n  if (container instanceof Element) {\n    targetContainer = container\n  } else if (isString(container)) {\n    targetContainer = document.getElementById(container)\n  } else {\n    targetContainer = document.createElement('div')\n  }\n\n  return targetContainer\n}\n\nexport const Query = {\n  parse(search = window.location.search) {\n    if (!search) return {}\n    const queryString = search[0] === '?' ? search.substring(1) : search\n    const query = {}\n    queryString.split('&')\n      .forEach(queryStr => {\n        const [key, value] = queryStr.split('=')\n        if (key) query[key] = value\n      })\n\n    return query\n  },\n  stringify(query, prefix = '?') {\n    const queryString = Object.keys(query)\n      .map(key => `${key}=${encodeURIComponent(query[key] || '')}`)\n      .join('&')\n    return queryString ? prefix + queryString : ''\n  },\n}\n\nfunction ajaxFactory(method) {\n  return function(apiPath, data = {}, base = 'https://api.github.com') {\n    const req = new XMLHttpRequest()\n    const token = localStorage.getItem(LS_ACCESS_TOKEN_KEY)\n\n    let url = `${base}${apiPath}`\n    let body = null\n    if (method === 'GET' || method === 'DELETE') {\n      url += Query.stringify(data)\n    }\n\n    const p = new Promise((resolve, reject) => {\n      req.addEventListener('load', () => {\n        const contentType = req.getResponseHeader('content-type')\n        const res = req.responseText\n        if (!/json/.test(contentType)) {\n          resolve(res)\n          return\n        }\n        const data = req.responseText ? JSON.parse(res) : {}\n        if (data.message) {\n          reject(new Error(data.message))\n        } else {\n          resolve(data)\n        }\n      })\n      req.addEventListener('error', error => reject(error))\n    })\n    req.open(method, url, true)\n\n    req.setRequestHeader('Accept', 'application/vnd.github.squirrel-girl-preview, application/vnd.github.html+json')\n    if (token) {\n      req.setRequestHeader('Authorization', `token ${token}`)\n    }\n    if (method !== 'GET' && method !== 'DELETE') {\n      body = JSON.stringify(data)\n      req.setRequestHeader('Content-Type', 'application/json')\n    }\n\n    req.send(body)\n    return p\n  }\n}\n\nexport const http = {\n  get: ajaxFactory('GET'),\n  post: ajaxFactory('POST'),\n  delete: ajaxFactory('DELETE'),\n  put: ajaxFactory('PUT'),\n}\n"]}